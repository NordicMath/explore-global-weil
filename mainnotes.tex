\documentclass[a4paper]{amsart}

\input{preamble}

\begin{document}

\title{Working notes on $m$-functions}
\maketitle

\tableofcontents

\section{Intro and summary}

We aim to collect all results obtained on $m$-functions and the various "helper" functions, including $h$, $c$, $\Psi$ and $g$.

An important part of this project includes the code base and the many different ways of plotting $m$ and the other functions. The plots and animations are collected in a Google Drive folder, while much of the code currently (Nov 2018) exists on local machines.



\subsection{Ideas and work in progress}

Right now (Nov 4th, 2018) it seems like the snake plot might be the most promising plot method, but we need to refine and test all the plotting technology further, while also doing more work on the theory side, especially on the $g$ function and the global functional equation (GFE).

\begin{enumerate}
\item IF we could understand (e.g. via numerical experiments) how the $h$-function looks for a given $m$-function, then we could maybe use this knowledge to DEFINE $m$ outside the unit circle. This would probably imply the pairing conjecture, and could possibly lead to a direct proof of the global functional equation for the underlying $L$-function, without relying on modular or automorphic forms. The reason for thinking this is that for Dirichlet characters, the pairing conjecture is essentially equivalent to the fact that $\chi$ is a character, which is in turn essentially equivalent to the GFE for the Dirichlet $L$-function.
\item In all the problems that follow it might be the case that Fourier analysis could help us. A conjecture is that for any $m$-function, the Fourier coefficients of $h(1, \theta)$ are rational numbers (perhaps with a simple formula).
\item Plan: Try to first understand $h(1, \theta)$ via the study of $c(r, \theta)$ as $r$ approaches $1$. Under some reasonable assumptions on $m$ it seems like $c(r, \theta)$ approaches $h(1, \theta)$, using that $m(1/z) \approx m(\bar{z})$ near any point on the unit circle where $m$ is continuous. Note that $c$ is defined on the open unit disc (unconditionally) but $c$ is not an analytic function.
\item Work first with Dirichlet characters, since in this case we know what the $m$-function is in the entire complex plane. This should also clarify which of our definitions and conjectures require the $m$-function to have real coefficients.
\item A good idea (?): Try to plot $\Psi(\theta)$ for different $m$-functions, maybe via the $c$-function as $r$ approaches 1.
\item Vague idea: Can we use power series inversion (applied to the denominator) to understand $c$ better?
\end{enumerate}


\section{Definitions}

\begin{definition}
  The $m$-function of $z$ associated to an arithmetic $f : \N \to \C$ is defined by the inifite sequence:
  $$m(z; f) = \sum_{n = 1}^{\infty} f(n) z^{n - 1}$$
\end{definition}

\begin{definition}
For any $m$-function $m(z)$,we define the associated $h$-function as
$$ h(z) = \frac{m(\frac{1}{z})}{m(z) }  $$
(which of course makes sense only if the $m$-function is defined outside of the unit circle).
\end{definition}

\begin{definition}
For any $m$-function $m(z)$,we define the associated $c$-function as
$$c(z) = \frac{m(\bar{z})}{m(z)}$$

\end{definition}

We write $h(r, \theta)$ for the $h$-function as a function of $z$ in polar coordinates, and similarly for $c$.

\begin{lemma}
(Do we need to assume real coefficients here??) We have
$$ \vert h(1, \theta) \vert = 1 $$
for all $\theta$.
\end{lemma}

\begin{definition}
Motivated by the previous lemma, we define
$$  \Psi(\theta) = \arg h(1, \theta)   $$
(we need to decide which branch of $\arg$ we use).
\end{definition}


\section{Background on complex analysis}

A hope is that there is a theorem which immediately implies that the number of poles on the unit circle of any $m$-function is finite, and that the number of zeroes on the unit disc is also finite. I (Andreas) am currently reading the book of Gamelin to find out, but we might need to ask on MathOverflow or search elsewhere.

An analytic (or meromorphic) function should be completely determined by its values on the real line, or on the unit circle (or any other curve segment). This means that if we understand for example $h$ on the unit circle, we can in principle reconstruct $h$ on the entire complex plane. BUT I (Andreas) don't know exactly how to do this. One possibility could be to use the Cauchy-Riemann equations, which we record here in their polar coordinate version.

\begin{proposition}
Assume that $f(z) = u(z) + i v(z) $ is an analytic function with real part $u$ and imaginary part $v$. Then we have
$$  \frac{\partial u}{\partial r} = \frac{1}{r} \frac{\partial v}{\partial \theta}$$
and
$$ \frac{1}{r} \frac{\partial u}{\partial \theta} = - \frac{\partial v}{\partial r} $$
\end{proposition}

\section{Plotting m-functions}


\subsection{Different methods for plotting}

There are many ways of plotting the $m$-function and its auxiliary functions.

\begin{enumerate}
\item Snake
\item \ldots (discuss and complete)
\end{enumerate}

Here are some further ideas:

\begin{enumerate}
\item IF we could find the zeroes of $m$ on the unit circle first, and write $p(z)$ for the polynomial (normalized via $p(0) = 1$) with those zeroes, then we could apply all of the previous plotting methods to $p(z)/m(z)$ instead. Now the former poles will become zeroes, and there are no obnoxious poles at all in the plots. An example is the elliptic curve 11a, where $p(z)$ MIGHT POSSIBLY be equal to $1-z^2$.
\item If we compose with arctan in front of any absolute value plot, we avoid the problem that values near poles go to infinity. Instead, the graph will look approximately linear (if the pole is a simple pole) and approximately quadratic (for a double pole) etc. See the arctan folder on Google Drive, and in particular IMG 0218 compared with IMG 0219. Note also that the coefficient in the numerator will affect the slope in a way that looks inversely proportional. Maybe we can modify the arctan function slightly to make the visual effects easier to interpret.
\end{enumerate}



\subsection{Convergence and bounds}

\begin{definition}
  We say that $m$ has proper convergence when the sum defining $m(z; f)$ absolutely converges whenever $|z| < 1$. All $m$-functions here have proper convergence unless otherwise stated.
\end{definition}

\begin{proposition}
  An $m$-function has proper convergence if and only if there exists an $N$ and a monomial $Bn^d$ such that $|f(n)| \le Bn^d$ for all $n \ge N$.
\end{proposition}

\begin{proof}
  The sum is absolutely convergent if and only if all tails of the function absolutely converge. Given an $N$ and a polynomial $P(x)$, look at the following tail:
  $$\sum_{n = N}^{\infty} |f(n)z^{n - 1}| = \sum_{n = N}^{\infty} |f(n)| |z|^{n - 1} \le \sum_{n = N}^{\infty} Bn^d |z|^{n - 1}$$
  We apply the Cauchy ratio test, and see that:
  $$L = \lim_{n \to \infty} \left|\frac{B(n + 1)^d |z|^{n}}{Bn^d |z|^{n - 1}}\right| = \lim_{n \to \infty} |z|\left|\frac{(n + 1)^d}{n^d}\right| = \lim_{n \to \infty} |z|\left|1 + \frac{ 1}{n}\right|^d = |z|$$
  From this, we see that whenever $|z| < 1$ we have absolute convergence of the $m$-function, which is what we wanted to show. For the other direction... \todo{how?}

\end{proof}

\section{Results on the $h$-function and the $c$-function}

Let's try to work out what the CR equations say (all of this paragraph might be completely wrong for some stupid reason). I think it is true that for the $h$-function, if we write $h = u+ iv$ and restrict attention to what happens on the unit circle, we get
$$ u(\theta) = \cos \Psi(\theta) \quad \quad \textrm{and} \quad \quad v(\theta) =  \sin \Psi(\theta) $$
from which we can determine $\frac{\partial u}{\partial \theta}$ and $\frac{\partial v}{\partial \theta}$. This should (using the chain rule) tell us what happens very near the unit circle as we vary $r$. But I don't see how to get to any differential equations that determine $h$ on the entire complex plane, BUT then again I haven't thought this through thoroughly at all.

\section{Plotting $h$ and $c$}




\section{Hadamard factorization and the $g$ function}

Add the relevant theorem here.

\section{The example of the Riemann $m$-function}

From the Riemann zeta function we get the $m$-function

$$ m(z) = \frac{1}{1-z}   $$

\begin{lemma}
For this $m$-function, we have
$$h(z) = -z$$
and
$$\Psi(\theta ) = \theta + \pi \pmod {2\pi}$$

\end{lemma}
Note that this gives a zig-zag function with nice Fourier coefficients.

\begin{proof}
The first statement follows immediately by a short computation. For the second statement, we have $h(1, \theta) = -e^{i \theta} = e^{i (\theta + \pi)} $
\end{proof}

\section{General results for Dirichlet characters}

It will be super-interesting to see what happens with $h$ and $c$ and $\Psi$ for Dirichlet characters.

\begin{proposition}
For any non-trivial Dirichet character $\chi$, the $h$-function is given by $h(z) = -\chi(-1) z^2$.
\end{proposition}
\begin{proof}
Since $\chi$ is periodic (with period $N$, say), we can write
$$ m(z) = \frac{1 + \chi(2) z + \ldots + \chi(N-1) z^{N-2} + \chi(N) z^{N-1}}{1-z^N} $$
and since $\chi(N) = \chi(0) = 0$ while $\chi(N-1)= \chi(-1) = \pm 1 \neq 0$, the degree of the numerator is $N-2$.

Expanding by $\chi(-1) z^N $ in the second step, and then using repeatedly that $\chi$ is multiplicative and periodic, we get
\begin{align*}
    m(\frac{1}{z}) &= \frac{1+\chi(2)/z + \chi(3) / z^2 + \ldots + \chi(N-2) / z^{N-3} + \chi(N-1) /z^{N-2} }{1-(1/z)^N}  \\
        &= \frac{z^2 \cdot \big( \chi(-1)z^{N-2} + \chi(-2) z^{N-3} + \ldots \chi(2-N) z + \chi(1-N) \big)}{\chi(-1) (z^N - 1 )} \\
        &= \frac{z^2}{- \chi(-1)} \cdot \frac{ \chi(N-1) z^{N-2} + \chi(N-2) z^{N-3} + \ldots + \chi(2) z + 1}{1-z^N} \\
        &= \frac{z^2}{-\chi(-1)} \cdot m(z) \\
        &= -\chi(-1) \cdot z^2 \cdot m(z)
\end{align*}
and the result follows.
\end{proof}

Remark: I think the proof also essentially proves the pairing conjecture, but we have to check carefully and write it down. The point is that the reverse polynomial of the numerator of $m$ is obtained from the original numerator just by substituting $1/z$ in place of $z$, and then multiplying by $\chi(-1) z^{N-2}$. But we have to check what happens with cancellation. Note that the Riemann example has just a single pole, so it cannot satisfy the pairing conjecture.

\begin{lemma}
We have $\prod_{j=1}^{N-1} (1-\omega^j) = N$.
\end{lemma}

\begin{proposition}
The residue of $m(z)$ at $\omega$ is given by
$$ Res(m, \omega) = - \frac{\tau(\chi)}{N}   $$
where $\tau(\chi)$ is the Gauss sum of $\chi$.
\end{proposition}

\begin{proof}
Define $f(z) = \chi(1) z + \chi(2) z^2 + \ldots + \chi(N-1) z^{N-1}$. Then $f(\omega)$ is the Gauss sum, and
$$m(z) = \frac{f(z)}{z-z^{N+1}}$$
which gives the result after a small computation.
\end{proof}
We could verify the lemma, then verify the proposition numerically, and also investigate what happens at other poles.

Together with \url{https://en.wikipedia.org/wiki/Gauss_sum} this will help us understand which roots of unity are poles and which ones are not.

\section{Examples of Dirichlet characters}

Unless otherwise stated, we consider the "Generator 0" given by Sage.

\subsection{Mod 3}

We get $m(z) = \frac{1}{1+z+z^2}$. The real plot on $[-1, 1]$ has minimum $\frac{1}{3}$ for $z=1$, and maximum $\frac{4}{3}$, for $z=-\frac{1}{2}$.

\subsection{Mod 4}



\subsection{Mod 5}


\subsection{Mod 15}


\end{document}
